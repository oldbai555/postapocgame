/**
 * @Author: zjj
 * @Date: 2025/11/12
 * @Desc: 系统数据定义 proto
**/

syntax = "proto3";
package pb3;
option go_package = "server/internal/protocol";
import "base.proto";

enum SystemId {
    SystemIdNil = 0;
    SysLevel = 1;// 等级系统
    SysBag = 2;// 背包系统
    SysMoney = 3;// 货币系统
    SysOfflineMsg = 4;// 离线消息系统
    SysGM = 5;// GM系统
    SysSkill = 6;// 技能系统
    SysAttr = 7;// 属性系统
    SysEquip = 8;// 装备系统
    SysVip = 9;// VIP系统
    SysQuest = 10;// 任务系统
    SysMail = 11;// 邮件系统
    SysShop = 12;// 个人商城系统
    SysDungeon = 13;// 副本系统
    SysItemUse = 14;// 物品使用系统
    SysOfflineReward = 15;// 离线收益系统
    SysAntiCheat = 16;// 防作弊系统
    SysDailyActivity = 17;// 日常活跃系统
    SysAchievement = 18;// 成就系统
    SysNewbie = 19;// 新手保护系统
    SysFriend = 20;// 好友系统
    SysGuild = 21;// 公会系统
    SysAuction = 22;// 拍卖行系统
    SysChat = 23;// 聊天系统
    SysRank = 24;// 排行榜系统

    SysIdMax = 25;// 最大系统ID 手动递增
}

// 任务系统
message QuestTypeList {
    repeated QuestData quests = 1;
}

message SiQuestData {
    map<uint32, QuestTypeList> quest_map = 1; // key: 任务类型
    map<uint32, int64> last_reset_map = 2; // key: 任务类型 value: 上次刷新时间
    map<uint32, uint32> quest_finish_count = 3; // key: 任务ID value: 当天/当周已完成次数（用于 MaxCount 限制）
}

// 等级系统
message SiLevelData {
    uint32 level = 1;
    int64 exp = 2;
}

// 背包系统
message SiBagData {
    repeated ItemSt items = 1;// 通用道具列表
}

// VIP 系统
message SiVipData {
    uint32 level = 1;
    uint32 exp = 2;
}

// 货币系统
message SiMoneyData {
    map<uint32, int64> moneyMap = 1;// key: 货币类型,
}

// 装备系统
message SiEquipData {
    repeated EquipSt equips = 1;// 装备列表
}

message EquipSt {
    uint32 item_id = 1;// 装备物品ID
    uint32 slot = 2;// 装备槽位
    uint32 level = 3;// 强化等级
    uint32 exp = 4;// 强化经验
    uint32 refine_level = 5;// 精炼等级（0表示未精炼）
    repeated AttrSt enchant_attrs = 6;// 附魔属性列表
    uint32 set_id = 7;// 套装ID（0表示不属于任何套装）
}

// 副本系统
message SiDungeonData {
    repeated DungeonRecord records = 1;// 副本记录列表
}

message DungeonRecord {
    uint32 dungeon_id = 1;// 副本ID
    uint32 difficulty = 2;// 难度: 1=普通 2=精英 3=地狱
    int64 last_enter_time = 3;// 最后进入时间（Unix时间戳）
    uint32 enter_count = 4;// 今日进入次数
    int64 reset_time = 5;// 重置时间（Unix时间戳，每日重置）
}

// 邮件系统
message SiMailData {
    repeated MailSt mails = 1;// 邮件列表
}

// 技能系统
message SiSkillData {
    map<uint32, uint32> skill_map = 1;// 技能列表（skillId -> level）
}

// 物品使用系统
message SiItemUseData {
    map<uint32, int64> cooldown_map = 1;// 物品冷却时间记录（itemId -> 冷却结束时间Unix时间戳）
}

// 离线收益系统
message SiOfflineRewardData {
    int64 last_logout_time = 1;// 最后登出时间（Unix时间戳）
    int64 total_offline_seconds = 2;// 累计离线时间（秒）
    bool reward_claimed = 3;// 是否已领取离线收益
    int64 last_claim_time = 4;// 最后领取时间（Unix时间戳）
}

// 防作弊系统
message SiAntiCheatData {
    map<string, int32> operation_count = 1;// 操作计数（操作类型 -> 计数）
    map<string, int64> last_operation_time = 2;// 最后操作时间（操作类型 -> Unix时间戳）
    int32 suspicious_count = 3;// 可疑行为计数
    int64 last_reset_time = 4;// 最后重置时间（Unix时间戳，用于每日重置）
    bool is_banned = 5;// 是否被封禁
    int64 ban_end_time = 6;// 封禁结束时间（Unix时间戳，0表示永久封禁）
}

// 日常活跃系统
message SiDailyActivityData {
    int64 balance = 1; // 当前活跃点余额
    uint32 today_points = 2; // 今日累计活跃点
    int64 last_reset_time = 3; // 最后重置时间（Unix时间戳）
    repeated DailyActivityRewardState reward_states = 4; // 奖励领取状态
}

message DailyActivityRewardState {
    uint32 reward_id = 1;// 奖励ID
    bool claimed = 2;// 是否已领取
}

// 成就系统
message SiAchievementData {
    repeated AchievementData achievements = 1;// 成就列表
}

message AchievementData {
    uint32 achievement_id = 1;// 成就ID
    repeated uint32 progress = 2;// 当前进度
    bool completed = 3;// 是否已完成
    int64 complete_time = 4;// 完成时间（Unix时间戳，0表示未完成）
}

// 新手保护系统
message SiNewbieData {
    bool is_newbie = 1;// 是否处于新手保护期
    int64 newbie_end_time = 2;// 新手保护结束时间（Unix时间戳）
    bool guide_completed = 3;// 新手引导是否完成
    map<uint32, bool> guide_progress = 4;// 新手引导进度（引导ID -> 是否完成）
}

// 好友系统
message SiFriendData {
    repeated uint64 friend_list = 1;           // 好友ID列表
    repeated uint64 friend_request_list = 2;    // 待处理的好友申请列表（别人申请加我为好友）
}

// 公会系统
message SiGuildData {
    uint64 guild_id = 1;    // 所属公会ID（0表示未加入公会）
    uint32 position = 2;    // 职位（GuildPosition枚举）
    int64 join_time = 3;    // 加入时间（Unix时间戳）
}

// 拍卖行系统
message SiAuctionData {
    repeated uint64 auction_id_list = 1; // 我上架的拍卖物品ID列表
}
